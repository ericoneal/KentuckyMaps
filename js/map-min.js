let hillshadeLayer,swipe,measurement,distanceButton,layerList,isSwipeActive=!1,isMeasureActive=!1;const urlStates="https://gis.blm.gov/arcgis/rest/services/Cadastral/BLM_Natl_PLSS_CadNSDI/MapServer/0";function SendEmail(e,a){e&&a?$.ajax({url:"https://eaoemail.appspot.com/",method:"GET",data:{FromEmail:e,Message:a},success:function(e){alert("Email sent successfully!"),$("#FromEmail").val(""),$("#Message").val(""),$("#emailModal").modal("hide"),"undefined"!=typeof expandWidget&&(expandWidget.expanded=!1)},error:function(e,a,t){alert("Failed to send email. Please try again."),console.error("Error:",t)}}):alert("Please provide both email and message.")}require(["esri/views/MapView","esri/WebMap","esri/widgets/Home","esri/widgets/Track","esri/widgets/LayerList","esri/widgets/Measurement","esri/widgets/Expand","esri/widgets/Swipe","esri/layers/FeatureLayer","esri/layers/WebTileLayer","esri/widgets/Search"],((e,a,t,i,s,r,l,n,o,d,c)=>{$("#startupModal").modal("show");const p=new a({portalItem:{id:"72484fdc2ac34b019571b035243a46e8"}}),m=new e({map:p,container:"viewDiv"}),u={title:"{name}",content:'\n      <b>Status:</b> {status}<br>\n      <a href="{Website_Link}" target="_blank"><img src="{image}" alt="Image" style="width: 100%; max-width: 300px;"/></a><br>\n       \n    '},w=new o({portalItem:{id:"38bb0649fae84c4ebacaacf8e0ffcb7a"},popupEnabled:!0,popupTemplate:u}),h=new o({portalItem:{id:"0b0074df55b444849d43e1e17f3e1426"},popupEnabled:!0,popupTemplate:u});p.when((()=>{p.layers.forEach((e=>{["World Dark Gray Reference","World Dark Gray Base","Kentucky","States","USA - States"].includes(e.title)&&(e.listMode="hide"),"Hillshade"===e.title&&(hillshadeLayer=e)}));p.findLayerById("layerIdHere")})).catch((e=>{console.error("Error loading WebMap:",e)})),m.when((()=>{m.constraints.geometry=m.extent,layerList=new s({view:m});const e=new l({view:m,content:layerList,expanded:!1});m.ui.add(e,"top-right"),measurement=new r({view:m,linearUnit:"miles"}),distanceButton=document.getElementById("distance"),distanceButton.addEventListener("click",(()=>{0==isMeasureActive?(measurement.activeTool="distance",distanceButton.classList.add("active"),isMeasureActive=!0):(distanceButton.classList.remove("active"),isMeasureActive=!1,measurement.clear())}))}));const y=new l({view:m,expandIcon:"envelope",expanded:!1});m.ui.add(y,"bottom-right"),y.watch("expanded",(function(e){$("#emailModal").modal("show"),y.collapse()})),$("#closeExpandButton").on("click",(function(){y.expanded=!1}));const v=new t({view:m});m.ui.add(v,"top-left");const f=new i({view:m});m.ui.add(f,"top-left");const g=new c({view:m,includeDefaultSources:!0,searchAllEnabled:!1,resultGraphicEnabled:!1,sources:[{layer:w,searchFields:["name"],displayField:"name",exactMatch:!1,outFields:["name"],name:"Waterfall",placeholder:"Waterfall Name"},{layer:h,searchFields:["Label"],displayField:"Label",exactMatch:!1,outFields:["Label"],name:"RRG Trails",placeholder:"Trail Name"}]});m.ui.add(g,{position:"top-right"}),g.on("select-result",(function(e){if("Waterfall"==e.source.name)for(var a=0;a<=layerList.operationalItems.items.length-1;a++)"Kentucky Waterfalls"==layerList.operationalItems.items[0].title&&(layerList.operationalItems.items[0].visible=!0);m.goTo({center:e.result.feature.geometry,zoom:16})}));const b=document.createElement("button");b.className="esri-widget esri-component esri-icon-elevation-profile",b.style.padding="8px",b.style.cursor="pointer",m.ui.add(b,"top-right"),b.addEventListener("click",(function(){if(isSwipeActive)swipe&&(m.ui.remove(swipe),swipe.destroy(),swipe=null),isSwipeActive=!1,hillshadeLayer.visible=!1;else{const[e,a]=p.layers.toArray();if(!e||!a)return void console.error("The WebMap must have at least two layers for the Swipe widget.");hillshadeLayer.visible=!0,swipe=new n({view:m,leadingLayers:[hillshadeLayer],position:50}),m.ui.add(swipe),isSwipeActive=!0}}))}));