let hillshadeLayer,swipe,isSwipeActive=!1,isMeasureActive=!1,measurement,distanceButton,layerList;const urlStates="https://gis.blm.gov/arcgis/rest/services/Cadastral/BLM_Natl_PLSS_CadNSDI/MapServer/0";function SendEmail(e,a){if(!e||!a){alert("Please provide both email and message.");return}$.ajax({url:"https://eaoemail.appspot.com/",method:"GET",data:{FromEmail:e,Message:a},success:function(e){alert("Email sent successfully!"),$("#FromEmail").val(""),$("#Message").val(""),$("#emailModal").modal("hide"),"undefined"!=typeof expandWidget&&(expandWidget.expanded=!1)},error:function(e,a,t){alert("Failed to send email. Please try again."),console.error("Error:",t)}})}require(["esri/views/MapView","esri/WebMap","esri/widgets/Home","esri/widgets/Track","esri/widgets/LayerList","esri/widgets/Measurement","esri/widgets/Expand","esri/widgets/Swipe","esri/layers/FeatureLayer","esri/layers/WebTileLayer","esri/widgets/Search"],(e,a,t,i,s,r,l,n,o,d,c)=>{$("#startupModal").modal("show");let p=new a({portalItem:{id:"72484fdc2ac34b019571b035243a46e8"}}),u=new e({map:p,container:"viewDiv"}),m={title:"{name}",content:`
      <b>Status:</b> {status}<br>
      <a href="{Website_Link}" target="_blank"><img src="{image}" alt="Image" style="width: 100%; max-width: 300px;"/></a><br>
       
    `},w=new o({portalItem:{id:"38bb0649fae84c4ebacaacf8e0ffcb7a"},popupEnabled:!0,popupTemplate:m});p.when(()=>{console.log("WebMap is loaded"),p.layers.forEach(e=>{console.log("Layer title:",e.title),console.log("Layer ID:",e.id);let a=["World Dark Gray Reference","World Dark Gray Base","Kentucky","States"];a.includes(e.title)&&(e.listMode="hide"),"Hillshade"===e.title&&(hillshadeLayer=e)});let e=p.findLayerById("layerIdHere");e?console.log("Found specific layer:",e.title):console.log("Layer not found.")}).catch(e=>{console.error("Error loading WebMap:",e)}),u.when(()=>{u.constraints.geometry=u.extent,layerList=new s({view:u});let e=new l({view:u,content:layerList,expanded:!1});u.ui.add(e,"top-right"),measurement=new r({view:u,linearUnit:"miles"}),(distanceButton=document.getElementById("distance")).addEventListener("click",()=>{L()})});let h=new l({view:u,expandIcon:"envelope",expanded:!1});u.ui.add(h,"bottom-right"),h.watch("expanded",function(e){$("#emailModal").modal("show"),h.collapse()}),$("#closeExpandButton").on("click",function(){h.expanded=!1});let y=new t({view:u});u.ui.add(y,"top-left");let v=new i({view:u});u.ui.add(v,"top-left");let g=new c({view:u,includeDefaultSources:!1,searchAllEnabled:!1,resultGraphicEnabled:!1,sources:[{name:"Address Search",placeholder:"",apiKey:"AAPTxy8BH1VEsoebNVZXo8HurAV31S2Y-Y-6Okd3ngyrprAvQy8rginxsJv4Kbu4GT3jnN_b-kx6-e8OpIRvzrj9O2snc1E3aDQRgD522q7E93_mgRDqsGCF184EDK1JCe2ZStk0W5YDRe8tqIYhhiRGzZ4GqrKzKbbFoRkACv9zaza0pUo_0CNXhYc7O7qNnLBlnr0kr9QiXmyBzlI9Ah5vwvBYpOt6xL5gGhOnxsItzVw.AT1_EV7usvwf",singleLineFieldName:"SingleLine",url:"https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer",placeholder:"Address"},{layer:w,searchFields:["Name"],displayField:"Name",exactMatch:!1,outFields:["Name"],name:"Waterfall",placeholder:"Waterfall Name"}]});u.ui.add(g,{position:"top-right"}),g.on("select-result",function(e){if("Waterfall"==e.source.name)for(var a=0;a<=layerList.operationalItems.items.length-1;a++)"Kentucky Waterfalls"==layerList.operationalItems.items[0].title&&(layerList.operationalItems.items[0].visible=!0);u.goTo({center:e.result.feature.geometry,zoom:16})});let f=document.createElement("button");function b(){if(isSwipeActive)swipe&&(u.ui.remove(swipe),swipe.destroy(),swipe=null),isSwipeActive=!1,hillshadeLayer.visible=!1;else{let[e,a]=p.layers.toArray();if(!e||!a){console.error("The WebMap must have at least two layers for the Swipe widget.");return}hillshadeLayer.visible=!0,swipe=new n({view:u,leadingLayers:[hillshadeLayer],position:50}),u.ui.add(swipe),isSwipeActive=!0}}function L(){!1==isMeasureActive?(measurement.activeTool="distance",distanceButton.classList.add("active"),isMeasureActive=!0):(distanceButton.classList.remove("active"),isMeasureActive=!1,measurement.clear())}f.className="esri-widget esri-component esri-icon-elevation-profile",f.style.padding="8px",f.style.cursor="pointer",u.ui.add(f,"top-right"),f.addEventListener("click",b)});