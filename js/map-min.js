let hillshadeLayer,swipe,measurement,distanceButton,layerList,isSwipeActive=!1,isMeasureActive=!1;const urlStates="https://gis.blm.gov/arcgis/rest/services/Cadastral/BLM_Natl_PLSS_CadNSDI/MapServer/0";function SendEmail(e,a){e&&a?$.ajax({url:"https://eaoemail.appspot.com/",method:"GET",data:{FromEmail:e,Message:a},success:function(e){alert("Email sent successfully!"),$("#FromEmail").val(""),$("#Message").val(""),$("#emailModal").modal("hide"),"undefined"!=typeof expandWidget&&(expandWidget.expanded=!1)},error:function(e,a,t){alert("Failed to send email. Please try again."),console.error("Error:",t)}}):alert("Please provide both email and message.")}require(["esri/views/MapView","esri/WebMap","esri/widgets/Home","esri/widgets/Track","esri/widgets/LayerList","esri/widgets/Measurement","esri/widgets/Expand","esri/widgets/Swipe","esri/layers/FeatureLayer","esri/layers/WebTileLayer","esri/widgets/Search"],((e,a,t,i,s,r,l,n,o,d,c)=>{$("#startupModal").modal("show");const p=new a({portalItem:{id:"72484fdc2ac34b019571b035243a46e8"}}),m=new e({map:p,container:"viewDiv"}),u=new o({portalItem:{id:"38bb0649fae84c4ebacaacf8e0ffcb7a"},popupEnabled:!0,popupTemplate:{title:"{name}",content:'\n      <b>Status:</b> {status}<br>\n      <a href="{Website_Link}" target="_blank"><img src="{image}" alt="Image" style="width: 100%; max-width: 300px;"/></a><br>\n       \n    '}});p.when((()=>{console.log("WebMap is loaded"),p.add(stravaHeatmap),p.layers.forEach((e=>{console.log("Layer title:",e.title),console.log("Layer ID:",e.id);["World Dark Gray Reference","World Dark Gray Base","Kentucky","States"].includes(e.title)&&(e.listMode="hide"),"Hillshade"===e.title&&(hillshadeLayer=e)}));const e=p.findLayerById("layerIdHere");e?console.log("Found specific layer:",e.title):console.log("Layer not found.")})).catch((e=>{console.error("Error loading WebMap:",e)})),m.when((()=>{m.constraints.geometry=m.extent,layerList=new s({view:m});const e=new l({view:m,content:layerList,expanded:!1});m.ui.add(e,"top-right"),measurement=new r({view:m,linearUnit:"miles"}),distanceButton=document.getElementById("distance"),distanceButton.addEventListener("click",(()=>{0==isMeasureActive?(measurement.activeTool="distance",distanceButton.classList.add("active"),isMeasureActive=!0):(distanceButton.classList.remove("active"),isMeasureActive=!1,measurement.clear())}))}));const w=new l({view:m,expandIcon:"envelope",expanded:!1});m.ui.add(w,"bottom-right"),w.watch("expanded",(function(e){$("#emailModal").modal("show"),w.collapse()})),$("#closeExpandButton").on("click",(function(){w.expanded=!1}));const h=new t({view:m});m.ui.add(h,"top-left");const v=new i({view:m});m.ui.add(v,"top-left");const g=new c({view:m,includeDefaultSources:!1,searchAllEnabled:!1,resultGraphicEnabled:!1,sources:[{name:"Address Search",placeholder:"",apiKey:"AAPTxy8BH1VEsoebNVZXo8HurAV31S2Y-Y-6Okd3ngyrprAvQy8rginxsJv4Kbu4GT3jnN_b-kx6-e8OpIRvzrj9O2snc1E3aDQRgD522q7E93_mgRDqsGCF184EDK1JCe2ZStk0W5YDRe8tqIYhhiRGzZ4GqrKzKbbFoRkACv9zaza0pUo_0CNXhYc7O7qNnLBlnr0kr9QiXmyBzlI9Ah5vwvBYpOt6xL5gGhOnxsItzVw.AT1_EV7usvwf",singleLineFieldName:"SingleLine",url:"https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer",placeholder:"Address"},{layer:u,searchFields:["Name"],displayField:"Name",exactMatch:!1,outFields:["Name"],name:"Waterfall",placeholder:"Waterfall Name"}]});m.ui.add(g,{position:"top-right"}),g.on("select-result",(function(e){if("Waterfall"==e.source.name)for(var a=0;a<=layerList.operationalItems.items.length-1;a++)"Kentucky Waterfalls"==layerList.operationalItems.items[0].title&&(layerList.operationalItems.items[0].visible=!0);m.goTo({center:e.result.feature.geometry,zoom:16})}));const y=document.createElement("button");y.className="esri-widget esri-component esri-icon-elevation-profile",y.style.padding="8px",y.style.cursor="pointer",m.ui.add(y,"top-right"),y.addEventListener("click",(function(){if(isSwipeActive)swipe&&(m.ui.remove(swipe),swipe.destroy(),swipe=null),isSwipeActive=!1,hillshadeLayer.visible=!1;else{const[e,a]=p.layers.toArray();if(!e||!a)return void console.error("The WebMap must have at least two layers for the Swipe widget.");hillshadeLayer.visible=!0,swipe=new n({view:m,leadingLayers:[hillshadeLayer],position:50}),m.ui.add(swipe),isSwipeActive=!0}}))}));